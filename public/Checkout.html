<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Checkout â€” Clone</title>
  <link rel="stylesheet" href="Checkout.css">
  <link rel="stylesheet" href="Navbar.css">
</head>
<body>

  <!-- Navbar -->
  <div id="navbar-container"></div>

  <!-- Checkout Page Content -->
  <div class="page">
    <div class="breadcrumb">Cart â€º <strong>Information</strong> â€º Shipping â€º Payment â€º Place Order</div>

    <div class="checkout">
      <main class="left-col">
        <h1 class="section-title">Information</h1>
        <input class="field full" type="email" placeholder="Email address">

        <h1 class="section-title">Shipping address</h1>
        <div class="two">
          <input class="field" type="text" placeholder="First name">
          <input class="field" type="text" placeholder="Last name">
        </div>

        <select class="field">
          <option>Kenya</option>
        </select>

        <select class="field">
          <option>Select an option...</option>
        </select>

        <input class="field" type="text" placeholder="Street address">
        <input class="field" type="text" placeholder="Apartment, suite, unit, etc.">
        <input class="field" type="text" placeholder="Town / City">
        <input class="field" type="text" placeholder="Phone">

        <a class="return-link">â€¹ Return to cart</a>

        <div class="actions">
          <button class="btn-primary">Select Shipping Method</button>
        </div>
      </main>

      <aside class="right-col">
        <div class="cart-item">
          <img src="https://via.placeholder.com/80" alt="product">
          <div class="item-meta">
            <div class="item-title">Product Name<br><span class="muted">SKU: 000000</span></div>
            <div class="prices">
              <span class="strike">KSh 0.00</span>
              <span class="price-small">KSh 0.00</span>
            </div>
          </div>
          <div class="item-total">KSh 0.00</div>
        </div>

        <div class="summary">
          <div class="summary-row"><span>Subtotal</span><span id="subtotal">KSh 0.00</span></div>
          <div class="summary-row"><span>Shipping</span><span id="shipping">Free!</span></div>
          <div class="divider"></div>
          <div class="summary-row total-row"><strong>Total</strong><strong id="total">KSh 0.00</strong></div>
          <div class="tax-note" id="tax-note">(includes KSh 0.00 Tax)</div>
        </div>

        <h3 class="secure-title">Secured Payments</h3>
        <div class="secure">
          <div class="paystack-badge">ðŸ”’</div>
          <div class="secure-text">Best in class security to ensure that your payments and data is secure.</div>
        </div>
      </aside>
    </div>
  </div>

<script>
   /* ========= FOOTER LOAD ========= */
  fetch("footer.html")
    .then(res => res.text())
    .then(html => {
      const footer = document.getElementById("footer-container");
      if (footer) footer.innerHTML = html;
    })
    .catch(err => console.error("Footer load error:", err));

document.addEventListener("DOMContentLoaded", () => {
  // Load Navbar
  fetch("Navbar.html")
    .then(res => res.text())
    .then(html => document.getElementById("navbar-container").innerHTML = html)
    .catch(err => console.error("Navbar load failed:", err));

  const cartItems = JSON.parse(localStorage.getItem("cart")) || [];
  const cartContainer = document.querySelector(".right-col");
  const subtotalEl = document.getElementById("subtotal");
  const totalEl = document.getElementById("total");
  const taxNoteEl = document.getElementById("tax-note");

  // Clear default cart-item
  const defaultItem = cartContainer.querySelector(".cart-item");
  if (defaultItem) defaultItem.remove();

  let subtotal = 0;

  cartItems.forEach(product => {
    const priceNumber = Number(product.price.replace(/[^0-9.-]+/g,""));
    const quantity = Number(product.quantity);
    const total = priceNumber * quantity;
    subtotal += total;

    const itemDiv = document.createElement("div");
    itemDiv.className = "cart-item";
    itemDiv.innerHTML = `
      <img src="${product.image}" alt="${product.title}">
      <div class="item-meta">
        <div class="item-title">${product.title}<br><span class="muted">SKU: ${product.sku}</span></div>
        <div class="prices">
          <span class="strike">${product.oldPrice}</span>
          <span class="price-small">${product.price}</span>
        </div>
      </div>
      <div class="item-total">KSh ${total.toLocaleString('en-US', {minimumFractionDigits:2})}</div>
    `;
    cartContainer.insertBefore(itemDiv, cartContainer.querySelector(".summary"));
  });

  // Update summary
  subtotalEl.textContent = `KSh ${subtotal.toLocaleString('en-US', {minimumFractionDigits:2})}`;
  totalEl.textContent = `KSh ${subtotal.toLocaleString('en-US', {minimumFractionDigits:2})}`;
  taxNoteEl.textContent = `(includes KSh 0.00 Tax)`; // No tax added

  // Save shipping info and proceed
  document.querySelector(".btn-primary").addEventListener("click", () => {
    const shippingInfo = {
      email: document.querySelector('input[type="email"]').value,
      firstName: document.querySelector('input[placeholder="First name"]').value,
      lastName: document.querySelector('input[placeholder="Last name"]').value,
      country: document.querySelectorAll('select.field')[0].value,
      region: document.querySelectorAll('select.field')[1].value,
      street: document.querySelector('input[placeholder="Street address"]').value,
      apartment: document.querySelector('input[placeholder="Apartment, suite, unit, etc."]').value,
      city: document.querySelector('input[placeholder="Town / City"]').value,
      phone: document.querySelector('input[placeholder="Phone"]').value
    };
    localStorage.setItem("shippingInfo", JSON.stringify(shippingInfo));
    window.location.href = "Shipping.html";
  });
});
</script>


</body>
<div id="footer-container"></div>
</html>
