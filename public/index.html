<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Holiday Deals</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Navbar placeholder -->
    <div id="navbar-container"></div>

    <!-- Main Content -->
    <div class="container">
        <!-- Header with background image -->
        <header class="header">
            <div class="header-content">
                <div class="header-right">
                    <h1>Holiday deals</h1>
                    <h2>Gifts for her under $50</h2>
                </div>
            </div>
        </header>

        <!-- Product Listing Container -->
        <div id="product-listing-container"></div>

        <!-- Categories Section -->
        <div class="categories">
            <!-- Shop by Price Section -->
            <section class="category">
                <h3>Shop gifts by price</h3>
                <div class="category-boxes">
                    <div class="category-item">
                        <img src="Assets/watch1.jpg" alt="Under $10">
                        <p>Under $10</p>
                    </div>
                    <div class="category-item">
                        <img src="Assets/watch2.jpg" alt="Under $25">
                        <p>Under $25</p>
                    </div>
                    <div class="category-item">
                        <img src="Assets/watch3.webp" alt="Under $50">
                        <p>Under $50</p>
                    </div>
                    <div class="category-item">
                        <img src="Assets/drown.webp" alt="Deals">
                        <p>Deals</p>
                    </div>
                </div>
            </section>

            <!-- Shop by Recipient Section -->
            <section class="category">
                <h3>Shop gifts by recipient</h3>
                <a href="Productcart.html" class="category-link">
                    <div class="category-boxes">
                        <div class="category-item">
                            <img src="Assets/croptop.jpg" alt="For Him">
                            <p>For him</p>
                        </div>
                        <div class="category-item">
                            <img src="Assets/socks1.jpg" alt="For Her">
                            <p>For her</p>
                        </div>
                        <div class="category-item">
                            <img src="Assets/swaeter.jpg" alt="For Kids">
                            <p>For kids</p>
                        </div>
                        <div class="category-item">
                            <img src="Assets/swaeter.jpg" alt="For Teens">
                            <p>For teens</p>
                        </div>
                    </div>
                </a>
            </section>

            <!-- Gaming Section -->
            <section class="category">
                <h3>Get your game on</h3>
                <a href="Productcart.html" class="category-link">
                    <div class="category-image">
                        <img src="Assets/drown.webp" alt="Gaming PC">
                    </div>
                </a>
            </section>

            <!-- Home Essentials Section -->
            <section class="category">
                <h3>Shop for your home essentials</h3>
                <div class="category-boxes">
                    <div class="category-item">
                        <img src="Assets/lamp.webp" alt="Cleaning Tools">
                        <p>Cleaning Tools</p>
                    </div>
                    <div class="category-item">
                        <img src="Assets/cctv.webp" alt="Home Storage">
                        <p>Home Storage</p>
                    </div>
                    <div class="category-item">
                        <img src="Assets/wire.webp" alt="Home Decor">
                        <p>Home Decor</p>
                    </div>
                    <div class="category-item">
                        <img src="Assets/cctv.webp" alt="Bedding">
                        <p>Bedding</p>
                    </div>
                </div>
            </section>

            <!-- Fashion Section -->
            <section class="category">
                <h3>Shop Fashion for less</h3>
                <div class="category-boxes">
                    <div class="category-item">
                        <img src="Assets/beanie.jpg" alt="Jeans under $50">
                        <p>Jeans under $50</p>
                    </div>
                    <div class="category-item">
                        <img src="Assets/beanie2.jpg" alt="Tops under $25">
                        <p>Tops under $25</p>
                    </div>
                </div>
            </section>
        </div>
    </div>

<script>
    // Load Navbar dynamically
    fetch('Navbar.html')
        .then(res => res.text())
        .then(data => {
            document.getElementById('navbar-container').innerHTML = data;
        })
        .catch(err => console.error('Error loading navbar:', err));

    // Load Product Listing dynamically
    fetch('Productlisting.html')
        .then(res => res.text())
        .then(data => {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = data;

            // Grab only the page-wrapper content
            const productContent = tempDiv.querySelector('.pl-page-wrapper');
            if(productContent) {
                document.getElementById('product-listing-container').appendChild(productContent);
            }

            // Add CSS for Product Listing
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = 'Productlisting.css';
            document.head.appendChild(link);

            // ===== Initialize Product Listing JS after HTML is injected =====
            initProductListing();
        })
        .catch(err => console.error('Error loading product listing:', err));

    function initProductListing() {
        // Sidebar toggle
        const burgerBtn = document.getElementById('pl-burger-btn');
        const sidebar = document.querySelector('.pl-sidebar');
        let overlay = document.getElementById('pl-overlay');

        // If overlay doesn't exist, create it (for safety)
        if (!overlay) {
            overlay = document.createElement('div');
            overlay.id = 'pl-overlay';
            overlay.classList.add('pl-overlay');
            document.body.appendChild(overlay);
        }

        burgerBtn?.addEventListener('click', () => {
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        });

        overlay?.addEventListener('click', () => {
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
        });

        // Price Slider and Filter
        const slider = document.querySelector('.pl-range-slider');
        const priceLabel = document.querySelector('.pl-price-label');
        const filterBtn = document.querySelector('.pl-filter-btn');
        const products = document.querySelectorAll('.pl-product-card');

        const minPrice = parseInt(slider.dataset.min);
        const maxPrice = parseInt(slider.dataset.max);

        slider.addEventListener('input', () => {
            const value = Math.round(minPrice + ((maxPrice - minPrice) * (slider.value / 100)));
            priceLabel.textContent = `Price: KSh ${value.toLocaleString()}`;
        });
        slider.dispatchEvent(new Event('input'));

        function parsePrice(priceText) {
            const range = priceText.replace(/[KSh,\s]/g, '').split('â€“');
            return range.map(p => parseInt(p.trim()));
        }

        filterBtn.addEventListener('click', () => {
            const selectedPrice = Math.round(minPrice + ((maxPrice - minPrice) * (slider.value / 100)));
            const tolerance = selectedPrice * 0.1; // 10% tolerance

            products.forEach(product => {
                const priceText = product.querySelector('.pl-product-price').textContent;
                const [productMin, productMax] = parsePrice(priceText).length === 2
                    ? parsePrice(priceText)
                    : [parsePrice(priceText)[0], parsePrice(priceText)[0]];

                product.style.display = (selectedPrice >= productMin - tolerance && selectedPrice <= productMax + tolerance)
                    ? 'block'
                    : 'none';
            });
        });
    }
</script>


</body>
</html>
